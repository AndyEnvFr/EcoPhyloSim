---
title: "Spatial Plots"
author: "Florian Hartig"
date: "27 Aug 2015"
output: html_document
---

```{r}
require(PhylGeo)
require(ape)
require(picante)
library(shape)
library(spam)
library(fields)
load("../results/results100x100.Rdata" )

outfolder = "plots100"

dir.create(paste("./",outfolder, sep = ""))
```


# Calculating p-values from null models 
This first impression leads to the assumption, that there is some signal in the phylogenetic dispersion which might help us identify environmental filtering or competitive exclusion as mechanisms. To quantify the degree of dispersion we compare our observed data against a null model. This null model can be calculated from the metacommunity or from samples.  


```{r, cache=T}

nullMeta <- calculatePhylogeneticDispersion(simulationOut, plotlengths = c(2,3,4,5,6,7,8,9,10), reduce = T, times = 40)
```

```{r, cache=T}

nullSample <- calculatePhylogeneticDispersion(simulationOut, type = "PhylSample", plotlengths = c(2,3,4,5,6,7,8,9,10), reduce = T)
```

```{r, cache=T}

samplePool <- calculatePhylogeneticDispersion(simulationOut, type = "SamplePool", plotlengths = c(2,3,4,5,6,7,8,9,10), reduce = T)
```

```{r, cache=T}

phylPool <- calculatePhylogeneticDispersion(simulationOut, type = "PhylPool", plotlengths = c(2,3,4,5,6,7,8,9,10), reduce = T)
```


```{r}

positions <- list(x= c(1, seq(2.5,6.5,1), 8),
                   y = c(4, 1:3),
                   xname = c("neutral", "1", "0.75", "0.5", "0.25", "0", "both"),
                   yname = c("global", "0.5", "2", "4" ))

```




```{r}
save.image( file = "NullModelResults.RData")

plotPhylogeneticDispersion(nullMeta, positions, "Null Meta", multiple = T) 

name =   name <- paste("./",outfolder, "/NullMeta.pdf", sep = "")

dev.copy(pdf, name , width=8, height=6)
dev.off()

plotPhylogeneticDispersion(nullSample, pars, "Null Sample", multiple = T) 

dev.copy(pdf,"./plots/NullSample.pdf", width=8, height=8)
dev.off()

plotPhylogeneticDispersion(samplePool, pars, "Null Sample Pool (picante)", multiple = T) 

dev.copy(pdf,"./plots/NullPicanteSample.pdf", width=8, height=8)
dev.off()

plotPhylogeneticDispersion(phylPool, pars, "Null Phyl Pool (picante)", multiple = T) 

dev.copy(pdf,"./plots/NullPicantePhylo.pdf", width=8, height=8)
dev.off()
```


